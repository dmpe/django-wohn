{% extends 'base.html' %}

{% load static %}
{% load staticfiles %}

{% block title %}Dashboard - User profile{% endblock %}

{% block description %}This page has a description.{% endblock %}

{% block robots %}index, follow{% endblock %}

{% block additional_head %}
	<link rel="stylesheet" href="{% static 'flags/sprite.css' %}">
	{% include "base_splitting/country_phone_libraries.html" %}
{% endblock %}

{% load crispy_forms_tags %}
{% load widget_tweaks %}
{% load countries %}
{% load tz %}

{% block content %}
<div class="container-fluid">

<!-- 
https://github.com/mfogel/django-timezone-field
https://github.com/dmpe/django-wohn/issues/18 
-->
	<div class="row">
        {% include 'nav_sidebar.html' %}

	    <div class="row col-md-9 col-lg-9 col-xl-10 pt-3">
	    	<div class="col-xs-12 col-md-6 col-lg-5 col-xl-3 pr-2">
	    		<div class="row">
					<img src="{{ gravatar_url }}" alt="My Profile picture" class="rounded img-fluid">
					<div class="row col-5 d-none d-sm-block d-md-none pl-2">

						<div class="input-group mb-3">
							<div class="custom-file pt-2">
								<input type="file" class="custom-file-input" id="customFile">
								<label class="custom-file-label" for="customFile">New profile image</label>
							</div>
							<div class="input-group-append">
								<span class="input-group-text" id="inputGroupFileAddon02">Upload</span>
							</div>
						</div>
					</div>
				</div>

				<div class="row d-none d-md-block">
					<div class="input-group mb-3">
						<div class="custom-file pt-2">
							<input type="file" class="custom-file-input" id="customFile">
							<label class="custom-file-label" for="customFile">Choose new profile image</label>
						</div>
						<div class="input-group-append">
							<span class="input-group-text" id="inputGroupFileAddon02">Upload</span>
						</div>
					</div>
				</div>
			</div>

	        <div class="col-xs-12 col-md-6 col-lg-7 col-xl-9 pt-2">
				<form method="POST" id="form-user-settings" class="mb-5">
				{% csrf_token %}		
					{{ form.non_field_errors | crispy }}
					{{ form.source.errors | crispy }}
					{{ form.source | crispy }}

					<div class="form-row">
						<div class="form-group col-xs-5 col-sm-6 col-md-12 col-lg-6 col-xl-3">
							{{ form.user_gender.label_tag  }}
							{{ form.user_gender.errors }}
							{{ form.user_gender | add_class:"form-control"}}
						</div>
						<div class="form-group col-xs-5 col-sm-6 col-md-12 col-lg-6 col-xl-4">
							{{ form.first_name.label_tag  }}
							{{ form.first_name.errors  }}							
							{{ form.first_name | add_class:"form-control"}}
						</div>
						<div class="form-group col-xs-5 col-sm-6 col-md-12 col-lg-6 col-xl-4">
							{{ form.last_name.label_tag  }}
							{{ form.last_name.errors }}
							{{ form.last_name | add_class:"form-control"}}
						</div>
						<div class="form-group col-xs-5 col-sm-6 col-md-12 col-lg-6 col-xl-3">
							{{ form.user_first_lastname_visibility.label_tag  }}
							{{ form.user_first_lastname_visibility.errors  }}
							{{ form.user_first_lastname_visibility | add_class:"form-control"}}
						</div>						
						<div class="form-group col-xs-5 col-sm-6 col-md-12 col-lg-6 col-xl-4">
							{{ form.user_int_tel.label_tag  }}
							{{ form.user_int_tel.errors  }}
							<input type="tel" name="phone" id="phone" class="form-control">
						</div>
						<div class="form-group col-xs-5 col-sm-6 col-md-12 col-lg-6 col-xl-4">
							{{ form.country.label_tag }}
							{{ form.country.errors }}
							{{ form.country | add_class:"form-control"}}
						</div>
						<div class="form-group col-xs-5 col-sm-6 col-md-12 col-lg-6 col-xl-4">
							{{ form.user_timezone.label_tag }}
							{{ form.user_timezone.errors }}
							{{ form.user_timezone | add_class:"form-control"}}
						</div>										
						<div class="form-group col-sm-5 col-sm-6 col-md-12 col-lg-6 col-xl-4">
							{{ form.user_units_system.label_tag }}
							{{ form.user_units_system.errors }}
							{{ form.user_units_system | add_class:"form-control"}}
						</div>								
									
					</div>
					<button type="submit" class="btn btn-warning mb-5 btn-lg btn-block">Save</button>
				</form>

				<form method="POST" id="form-user-username" class="mb-5">
				{% csrf_token %}
					{{ form.non_field_errors | crispy }}
					{{ form.source.errors | crispy }}
					{{ form.source | crispy }}
					<div class="row">
						<div class="form-group col-md-3 col-sm-5">
							<label for="user_id_username">Current username</label>
							<input class="form-control" type="text" name="user_id_username" value="{{ user.get_username }}" readonly="">
						</div>	

						<div class="form-group col-md-3 col-sm-5">
							{{ form.inputUsername.label_tag  }}
							{{ form.inputUsername.errors  }}
							{{ form.inputUsername | add_class:"form-control"}}
						</div>		
					</div>
					<button type="submit" class="btn btn-warning mb-5 btn-lg">Save</button>
				</form>

				<form method="POST" id="form-user-email" class="mb-5">
				{% csrf_token %}		
					{{ form.non_field_errors | crispy }}
					{{ form.source.errors | crispy }}
					{{ form.source | crispy }}
					<div class="row">
						<div class="form-group col-md-3 col-sm-5">
							<label for="user_id_email">Current email</label>
							<input class="form-control" type="text" name="" value="{{ user.email }}" readonly="">
						</div>	

						<div class="form-group col-md-3 col-sm-5">
							{{ form.inputEmail.label_tag  }}
							{{ form.inputEmail.errors  }}
							{{ form.inputEmail | add_class:"form-control"}}
						</div>
					</div>
					<button type="submit" class="btn btn-warning mb-5 btn-lg">Save</button>
				</form>

				<form method="POST" id="form-user-password" class="mb-5">
				{% csrf_token %}		
					{{ form.non_field_errors | crispy }}
					{{ form.source.errors | crispy }}
					{{ form.source | crispy }}
					<div class="row">
						<div class="form-group col-md-3 col-sm-5">
							{{ form.inputNewPassword.label_tag  }}
							{{ form.inputNewPassword.errors  }}
							{{ form.inputNewPassword | add_class:"form-control"}}
						</div>
						<div class="form-group col-md-3 col-sm-5">
							{{ form.inputConfirmNewPassword.label_tag  }}
							{{ form.inputConfirmNewPassword.errors  }}
							{{ form.inputConfirmNewPassword | add_class:"form-control"}}
						</div>
					</div>
					<button type="submit" class="btn btn-warning mb-5 btn-lg">Save</button>
				</form>				
			</div>		
				<!--
		        <p>Change currency, because default is CZK</p>
		        <p>Change mt^2 to sq. foot</p> -->
		</div>
	</div>
	
	<script>
		$(document).ready(function() {
			bsCustomFileInput.init()
		});

		var input = document.querySelector("#phone");
		
		window.intlTelInput(input, {
			preferredCountries: ["cz", "sk"],
			separateDialCode: true,
			utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/14.0.6/js/utils.js"
		});
	</script>		
	<script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input@1.3.1/dist/bs-custom-file-input.min.js" integrity="sha256-Kf72uYqY9REOgAOMF5o3jzROuWqX0CFpDUKaOHX27dQ=" crossorigin="anonymous"></script>
</div>
{% endblock %}